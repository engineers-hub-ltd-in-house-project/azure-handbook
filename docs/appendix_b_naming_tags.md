# 付録B: 命名規約・タグ・リージョン方針

本書の第1章で、命名規約とタグ付けの基本について触れましたが、この付録では、より実践的なガイドラインと推奨事項について詳述します。

一貫性のある命名規約とタグ戦略は、リソースの識別、コスト管理、自動化、そしてセキュリティ運用を大幅に簡素化するための基本です。

## 1. 命名規約

Azureのリソース名は、リソースの種類によってグローバルで一意である必要があるもの（ストレージアカウントなど）と、リソースグループ内で一意であればよいものがあります。そのため、規約はシンプルかつ拡張可能であることが望ましいです。

**推奨フォーマット**: `<sys>-<env>-<region>-<resourcetype>-<seq>`

-   **`<sys>`**: システムやアプリケーションの識別子 (例: `hdbk` `billing` `auth`)
-   **`<env>`**: 環境 (例: `prod` `stg` `dev` `test` `poc`)
-   **`<region>`**: リソースがデプロイされるリージョンの省略形 (例: `jpe` `jwe` `use` `euw`)
-   **`<resourcetype>`**: Azureリソースタイプの省略形
-   **`<seq>`**: 同じ種類のリソースが複数ある場合の連番 (例: `001` `002`)

**リソースタイプの省略形（例）**

| リソースタイプ                  | 省略形 | 備考                               |
| ------------------------------- | ------ | ---------------------------------- |
| Resource Group                  | `rg`   |                                    |
| Virtual Network                 | `vnet` |                                    |
| Subnet                          | `snet` |                                    |
| Network Security Group          | `nsg`  |                                    |
| Public IP Address               | `pip`  |                                    |
| Virtual Machine                 | `vm`   |                                    |
| Storage Account                 | `st`   | グローバルで一意な名前が必要       |
| Key Vault                       | `kv`   | グローバルで一意な名前が必要       |
| Log Analytics Workspace         | `law`  |                                    |
| Azure Container Apps Environment | `acaenv` |                                    |
| Azure Container App             | `aca`  |                                    |
| PostgreSQL Flexible Server      | `pgs`  |                                    |

**具体例**: `billing-prod-jpe-kv-001` は、「課金システムの」「本番環境用の」「東日本リージョンの」「Key Vault」の「1番目」であることが一目でわかります。

## 2. タグ戦略

タグは、リソースにメタデータを付与し、様々な観点から分類・整理するための強力なツールです。Azure Policyと組み合わせることで、必須タグの付与を強制することもできます。

**推奨される必須タグ**

| タグ名         | 説明                                                                 | 例                               |
| -------------- | -------------------------------------------------------------------- | -------------------------------- |
| `owner`        | そのリソースの管理責任者（個人名またはチームのメールアドレス）         | `yusuke@example.com`             |
| `costCenter`   | そのリソースのコストを負担する部署やプロジェクト                     | `R&D-Dept` `Project-X`           |
| `env`          | リソースが属する環境（本番、ステージング、開発など）                 | `prod` `stg` `dev`               |
| `dataClass`    | そのリソースが扱うデータの機密性レベル                             | `Public` `Internal` `Confidential` |
| `createdDate`  | そのリソースが作成された日付 (YYYY-MM-DD)                            | `2025-09-15`                     |
| `expiryDate`   | そのリソースが不要になる予定日（特に検証環境で有効）               | `2025-10-15`                     |

## 3. リージョン方針

リソースをデプロイするAzureリージョンを選択する際には、以下の要素を考慮します。

-   **レイテンシ**: ユーザーや他のシステムに最も近いリージョンを選択することで、ネットワーク遅延を最小化します。
-   **サービスの可用性**: すべてのAzureサービスがすべてのリージョンで利用可能なわけではありません。特に最新のサービスを利用する場合は、リージョンごとの提供状況を事前に確認する必要があります。
-   **データ主権 (Data Sovereignty)**: 国や地域の規制により、特定のデータを国内に留めておく必要がある場合があります。その場合は、その国の法律に準拠したリージョン（日本では東日本/西日本リージョン）を選択します。
-   **災害対策 (Disaster Recovery)**: 高い可用性が求められるシステムでは、**ペアになっているリージョン**（例: 東日本と西日本）にリソースを分散配置し、一方のリージョンで大規模な障害が発生した場合に備える戦略が一般的です。
